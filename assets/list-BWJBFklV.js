import{r as l,j as e}from"./index-Cf16QPBh.js";import{u as K,c as D,F as Q}from"./Form-DlZ-lmg6.js";import{c as M,g5 as u}from"./index-DZgKMGNH.js";import{S as W,T as L}from"./trash-2-LTKPkmeO.js";const Y=[["path",{d:"M21 12a9 9 0 0 0-9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"14sxne"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}],["path",{d:"M3 12a9 9 0 0 0 9 9 9.75 9.75 0 0 0 6.74-2.74L21 16",key:"1hlbsb"}],["path",{d:"M16 16h5v5",key:"ccwih5"}]],Z=M("refresh-ccw",Y);const ee=[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a1 1 0 0 1 3 3l-9.013 9.014a2 2 0 0 1-.853.505l-2.873.84a.5.5 0 0 1-.62-.62l.84-2.873a2 2 0 0 1 .506-.852z",key:"ohrbg2"}]],te=M("square-pen",ee);function se(){const{dataList:r,error:p,isLoading:E,isUpdating:I,isDeleting:g,fetchData:o,updateData:z,deleteData:O}=K({autoFetch:!0}),[n,b]=l.useState(""),[y,j]=l.useState(null),[P,f]=l.useState(!1),[N,d]=l.useState(null),[c,v]=l.useState(null),[T,w]=l.useState(!1),[k,x]=l.useState(null),C=l.useMemo(()=>{const t=n.trim().toLowerCase();return t?r.filter(s=>{const h=String(s.id).includes(t),R=s.company.toLowerCase().includes(t),V=s.postalCode.toLowerCase().includes(t),A=[s.prefecture,s.city,s.address,s.building].filter(Boolean).join(" ").toLowerCase().includes(t),B=s.tel.toLowerCase().includes(t),H=s.emails.some(G=>G.toLowerCase().includes(t)),J=D[s.contractStatus]||"",X=s.contractStatus.toLowerCase().includes(t)||J.toLowerCase().includes(t);return h||R||V||A||B||H||X}):r},[r,n]),a=l.useMemo(()=>r.find(t=>t.id===y)??null,[r,y]),S=l.useMemo(()=>r.find(t=>t.id===c)??null,[r,c]),_=l.useMemo(()=>{if(!a)return;const{...t}=a;return t},[a]),q=t=>{j(t),f(!0),d(null)},m=()=>{f(!1),j(null),d(null)},F=t=>{v(t),w(!0),x(null)},i=()=>{w(!1),v(null),x(null)},U=async t=>{if(a)try{await z(a.id,t),m()}catch(s){console.error(s),d("更新に失敗しました。時間をおいて再度お試しください。")}},$=async()=>{if(c)try{await O(c),i()}catch(t){console.error(t),x("削除に失敗しました。時間をおいて再度お試しください。")}};return E?e.jsx("div",{className:"text-center py-8",children:e.jsx("p",{className:"text-gray-500",children:"読み込み中..."})}):p?e.jsxs("div",{className:"text-center py-8",children:[e.jsx("p",{className:"text-red-500",children:p}),e.jsx("button",{onClick:o,className:"mt-4 px-4 py-2 bg-blue-500 text-white rounded hover:bg-blue-600",children:"再読み込み"})]}):r.length===0?e.jsxs("div",{className:"text-center py-8",children:[e.jsx("p",{className:"text-gray-500",children:"保存されたデータがありません"}),e.jsx("button",{onClick:o,className:"mt-4 px-4 py-2 bg-blue-500 text-white rounded hover:bg-blue-600",children:"再読み込み"})]}):e.jsxs("div",{className:"max-w-6xl mx-auto py-6 px-8 bg-neutral-50 rounded-2xl text-gray-800",children:[e.jsxs("div",{className:"flex justify-between items-center mb-5",children:[e.jsx("h2",{className:"text-3xl font-bold",children:"データ一覧"}),e.jsxs("button",{type:"button",onClick:o,className:"group px-4 py-2 border border-zinc-300 hover:border-zinc-400 rounded-2xl text-gray-800 bg-indigo-50 hover:bg-indigo-100 transition-colors duration-200",children:[e.jsx(Z,{className:"inline-block h-5 w-5 text-gray-700 group-hover:-rotate-45 transition-all"}),e.jsx("p",{className:"text-xs text-gray-600",children:"更新"})]})]}),e.jsx("div",{className:"mb-12 grid place-items-center",children:e.jsx("form",{className:"flex w-full items-center",onSubmit:t=>t.preventDefault(),children:e.jsxs("div",{className:"relative flex-1 mr-3",children:[e.jsx(W,{className:"pointer-events-none absolute left-3 top-1/2 h-6 w-6 -translate-y-1/2 text-gray-400"}),e.jsx("input",{type:"text",name:"search",id:"search",value:n,onChange:t=>b(t.target.value),placeholder:"会社名、住所、電話番号などで検索",className:"w-full rounded-full border border-gray-100 bg-white px-12 py-2 shadow/20 hover:shadow-md focus:outline-0"}),n&&e.jsx("button",{type:"button",onClick:()=>b(""),children:e.jsx(u,{className:"absolute right-3 top-1/2 h-6 w-6 -translate-y-1/2 text-gray-500 hover:rotate-90 hover:scale-110 transition-all"})})]})})}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 ",children:C.map(t=>e.jsxs("div",{className:"border border-zinc-200 shadow-xs rounded-3xl p-4 bg-white flex flex-col h-full",children:[e.jsxs("div",{className:"mb-3 flex justify-between data-start items-center ",children:[e.jsx("h3",{className:"text-xl text-gray-800 font-semibold",children:t.company}),e.jsxs("span",{className:"text-xs text-gray-500 mr-4",children:["ID: ",t.id]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3 text-sm flex-1",children:[e.jsxs("div",{className:"inline-flex",children:[e.jsx("p",{className:"font-semibold text-gray-600",children:"郵便番号:"}),e.jsx("p",{className:"ml-2 text-gray-800",children:t.postalCode})]}),e.jsxs("div",{className:"inline-flex",children:[e.jsx("p",{className:"font-semibold text-gray-600",children:"電話:"}),e.jsx("p",{className:"ml-2 text-gray-800",children:t.tel})]}),e.jsxs("div",{className:"col-span-2 inline-flex",children:[e.jsx("p",{className:"font-semibold text-gray-600 text-nowrap",children:"住所:"}),e.jsxs("p",{className:"ml-2 text-gray-800",children:[t.prefecture,t.city,t.address,t.building&&` ${t.building}`]})]}),e.jsxs("div",{className:"col-span-2 inline-flex",children:[e.jsx("p",{className:"font-semibold text-gray-600",children:"メール:"}),e.jsx("div",{className:"ml-2 text-gray-800",children:t.emails.map((s,h)=>e.jsx("div",{className:"text-blue-700",children:s},h))})]}),e.jsxs("div",{className:"inline-flex",children:[e.jsx("p",{className:"font-semibold text-gray-600",children:"契約日:"}),e.jsx("p",{className:"ml-2 text-gray-800",children:t.contractDate})]}),e.jsxs("div",{className:"inline-flex",children:[e.jsx("p",{className:"font-semibold text-gray-600",children:"契約状態:"}),e.jsx("p",{className:"ml-2 text-gray-800",children:D[t.contractStatus]})]}),t.cancellationDate&&e.jsxs("div",{className:"col-spam-2 inline-flex",children:[e.jsx("p",{className:"font-semibold text-gray-600",children:"解約日:"}),e.jsx("p",{className:"ml-2 text-gray-800",children:t.cancellationDate})]})]}),e.jsxs("div",{className:"flex justify-between mt-3 pt-3 border-t border-gray-200 items-center",children:[e.jsxs("div",{className:"text-xs text-gray-600",children:["作成日: ",new Date(t.createdAt).toLocaleString("ja-JP")]}),e.jsxs("div",{children:[e.jsxs("button",{type:"button",onClick:()=>q(t.id),className:"group text-xs rounded-full mr-2 cursor-pointer hover:bg-gray-100 px-2 py-1",children:[e.jsx(te,{className:"inline-block h-4 w-4 text-gray-500 group-hover:text-gray-600"}),e.jsx("span",{className:"text-gray-500 group-hover:text-gray-600",children:"編集"})]}),e.jsxs("button",{type:"button",onClick:()=>F(t.id),className:"group text-xs rounded-full mr-2 cursor-pointer hover:bg-gray-100 px-2 py-1",children:[e.jsx(L,{className:"inline-block h-4 w-4 text-gray-500 group-hover:text-gray-600"}),e.jsx("span",{className:"text-gray-500 group-hover:text-gray-600",children:"削除"})]})]})]})]},t.id))}),e.jsxs("div",{className:"mt-8 text-center text-sm text-gray-600",children:["全 ",C.length," 件"]}),P&&a&&e.jsx("div",{className:"fixed inset-0 z-50 bg-black/40 overflow-y-auto",onClick:m,children:e.jsx("div",{className:"min-h-full flex items-center justify-center px-4 py-8",children:e.jsxs("div",{className:"relative w-full max-w-3xl bg-white rounded-3xl shadow-lg p-6 max-h-[90vh] overflow-y-auto",onClick:t=>t.stopPropagation(),children:[e.jsx("div",{className:"sticky top-0 flex justify-end pb-2",children:e.jsx("button",{type:"button",onClick:m,className:"text-gray-400 hover:text-gray-600",children:e.jsx(u,{className:"h-10 w-10"})})}),e.jsxs("h3",{className:"text-2xl font-semibold mb-4",children:["「",a.company,"」を編集"]}),N&&e.jsx("p",{className:"text-red-500 text-sm mb-3",children:N}),e.jsx(Q,{mode:"edit",initialValues:_,onSubmit:U,submitLabel:I?"更新中...":"更新する"})]})})}),T&&e.jsx("div",{className:"fixed inset-0 z-50 backdrop-blur-sm bg-black/40 overflow-y-auto",onClick:i,children:e.jsx("div",{className:"min-h-full flex items-center justify-center px-4 py-8",children:e.jsxs("div",{className:"relative w-full max-w-xl py-15 bg-white rounded-3xl shadow-lg p-6 max-h-[90vh] overflow-y-auto",onClick:t=>t.stopPropagation(),children:[e.jsx("div",{className:"absolute top-5 right-5 flex justify-end pb-2",children:e.jsx("button",{type:"button",onClick:i,className:"text-gray-400 hover:text-gray-600",children:e.jsx(u,{className:"h-10 w-10"})})}),e.jsx(L,{className:"block h-20 w-20 p-5 mx-auto mb-10 text-rose-700 bg-red-100 rounded-full"}),e.jsxs("div",{className:"w-100 mx-auto",children:[e.jsx("h3",{className:"text-2xl font-bold mb-4 text-center",children:S&&`"${S.company}" を削除しますか？`}),e.jsx("p",{className:"text-gray-500 text-sm mb-10  text-center",children:"本当にこのデータを削除しますか？この操作は取り消しできません。"}),k&&e.jsx("p",{className:"text-red-500 text-sm text-center mb-5",children:k})]}),e.jsxs("div",{className:"flex justify-center",children:[e.jsx("button",{onClick:i,type:"button",className:"bg-neutral-50 hover:bg-neutral-100 text-gray-800 font-bold w-50 px-10 py-3 mr-5 rounded-xl border border-zinc-300",children:"キャンセル"}),e.jsx("button",{type:"button",onClick:$,disabled:g,className:"bg-red-700 hover:bg-red-600 disabled:bg-red-400 text-gray-50 font-bold w-50 px-10 py-3 rounded-xl border border-zinc-300",children:g?"削除中...":"削除"})]})]})})})]})}const ce=()=>e.jsx(se,{});export{ce as component};
