import{r as a,j as e}from"./index-BzlDlMMt.js";import{c as x,u as P,a as b,C as f,F as U}from"./Form-DRb0SXgH.js";const $=[["path",{d:"M21 12a9 9 0 0 0-9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"14sxne"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}],["path",{d:"M3 12a9 9 0 0 0 9 9 9.75 9.75 0 0 0 6.74-2.74L21 16",key:"1hlbsb"}],["path",{d:"M16 16h5v5",key:"ccwih5"}]],O=x("refresh-ccw",$);const R=[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]],T=x("search",R);const V=[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a1 1 0 0 1 3 3l-9.013 9.014a2 2 0 0 1-.853.505l-2.873.84a.5.5 0 0 1-.62-.62l.84-2.873a2 2 0 0 1 .506-.852z",key:"ohrbg2"}]],A=x("square-pen",V);function B(){const{dataList:r,error:m,fetchData:c,isLoading:N,isUpdating:v,updateData:w}=P({autoFetch:!0}),[n,h]=a.useState(""),[u,p]=a.useState(null),[C,g]=a.useState(!1),[y,i]=a.useState(null),j=a.useMemo(()=>{const s=n.trim().toLowerCase();return s?r.filter(t=>{const d=String(t.id).includes(s),M=t.company.toLowerCase().includes(s),D=t.postalCode.toLowerCase().includes(s),E=[t.prefecture,t.city,t.address,t.building].filter(Boolean).join(" ").toLowerCase().includes(s),I=t.tel.toLowerCase().includes(s),_=t.emails.some(F=>F.toLowerCase().includes(s)),z=b[t.contractStatus]||"",q=t.contractStatus.toLowerCase().includes(s)||z.toLowerCase().includes(s);return d||M||D||E||I||_||q}):r},[r,n]),l=a.useMemo(()=>r.find(s=>s.id===u)??null,[r,u]),k=a.useMemo(()=>{if(!l)return;const{...s}=l;return s},[l]),L=s=>{p(s),g(!0),i(null)},o=()=>{g(!1),p(null),i(null)},S=async s=>{if(l)try{await w(l.id,s),o()}catch(t){console.error(t),i("更新に失敗しました。時間をおいて再度お試しください。")}};return N?e.jsx("div",{className:"text-center py-8",children:e.jsx("p",{className:"text-gray-500",children:"読み込み中..."})}):m?e.jsxs("div",{className:"text-center py-8",children:[e.jsx("p",{className:"text-red-500",children:m}),e.jsx("button",{onClick:c,className:"mt-4 px-4 py-2 bg-blue-500 text-white rounded hover:bg-blue-600",children:"再読み込み"})]}):r.length===0?e.jsxs("div",{className:"text-center py-8",children:[e.jsx("p",{className:"text-gray-500",children:"保存されたデータがありません"}),e.jsx("button",{onClick:c,className:"mt-4 px-4 py-2 bg-blue-500 text-white rounded hover:bg-blue-600",children:"再読み込み"})]}):e.jsxs("div",{className:"max-w-6xl mx-auto py-6 px-8 bg-neutral-50 rounded-2xl text-gray-800",children:[e.jsxs("div",{className:"flex justify-between items-center mb-5",children:[e.jsx("h2",{className:"text-3xl font-bold",children:"データ一覧"}),e.jsxs("button",{type:"button",onClick:c,className:"group px-4 py-2 border border-zinc-300 hover:border-zinc-400 rounded-2xl text-gray-800 bg-indigo-50 hover:bg-indigo-100 transition-colors duration-200",children:[e.jsx(O,{className:"inline-block h-5 w-5 text-gray-700 group-hover:-rotate-45 transition-all"}),e.jsx("p",{className:"text-xs text-gray-600",children:"更新"})]})]}),e.jsx("div",{className:"mb-12 grid place-items-center",children:e.jsx("form",{className:"flex w-full items-center",onSubmit:s=>s.preventDefault(),children:e.jsxs("div",{className:"relative flex-1 mr-3",children:[e.jsx(T,{className:"pointer-events-none absolute left-3 top-1/2 h-6 w-6 -translate-y-1/2 text-gray-400"}),e.jsx("input",{type:"text",name:"search",id:"search",value:n,onChange:s=>h(s.target.value),placeholder:"会社名、住所、電話番号などで検索",className:"w-full rounded-full border border-gray-100 bg-white px-12 py-2 shadow/20 hover:shadow-md focus:outline-0"}),n&&e.jsx("button",{type:"button",onClick:()=>h(""),children:e.jsx(f,{className:"absolute right-3 top-1/2 h-6 w-6 -translate-y-1/2 text-gray-500 hover:rotate-90 hover:scale-110 transition-all"})})]})})}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 ",children:j.map(s=>e.jsxs("div",{className:"border border-zinc-200 shadow-xs rounded-3xl p-4 bg-white flex flex-col h-full",children:[e.jsxs("div",{className:"mb-3 flex justify-between data-start items-center ",children:[e.jsx("h3",{className:"text-xl text-gray-800 font-semibold",children:s.company}),e.jsxs("span",{className:"text-xs text-gray-500 mr-4",children:["ID: ",s.id]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3 text-sm flex-1",children:[e.jsxs("div",{className:"inline-flex",children:[e.jsx("p",{className:"font-semibold text-gray-600",children:"郵便番号:"}),e.jsx("p",{className:"ml-2 text-gray-800",children:s.postalCode})]}),e.jsxs("div",{className:"inline-flex",children:[e.jsx("p",{className:"font-semibold text-gray-600",children:"電話:"}),e.jsx("p",{className:"ml-2 text-gray-800",children:s.tel})]}),e.jsxs("div",{className:"col-span-2 inline-flex",children:[e.jsx("p",{className:"font-semibold text-gray-600 text-nowrap",children:"住所:"}),e.jsxs("p",{className:"ml-2 text-gray-800",children:[s.prefecture,s.city,s.address,s.building&&` ${s.building}`]})]}),e.jsxs("div",{className:"col-span-2 inline-flex",children:[e.jsx("p",{className:"font-semibold text-gray-600",children:"メール:"}),e.jsx("div",{className:"ml-2 text-gray-800",children:s.emails.map((t,d)=>e.jsx("div",{className:"text-blue-700",children:t},d))})]}),e.jsxs("div",{className:"inline-flex",children:[e.jsx("p",{className:"font-semibold text-gray-600",children:"契約日:"}),e.jsx("p",{className:"ml-2 text-gray-800",children:s.contractDate})]}),e.jsxs("div",{className:"inline-flex",children:[e.jsx("p",{className:"font-semibold text-gray-600",children:"契約状態:"}),e.jsx("p",{className:"ml-2 text-gray-800",children:b[s.contractStatus]})]}),s.cancellationDate&&e.jsxs("div",{className:"col-spam-2 inline-flex",children:[e.jsx("p",{className:"font-semibold text-gray-600",children:"解約日:"}),e.jsx("p",{className:"ml-2 text-gray-800",children:s.cancellationDate})]})]}),e.jsxs("div",{className:"flex justify-between mt-3 pt-3 border-t border-gray-200 items-center",children:[e.jsxs("div",{className:"text-xs text-gray-600",children:["作成日: ",new Date(s.createdAt).toLocaleString("ja-JP")]}),e.jsxs("button",{type:"button",onClick:()=>L(s.id),className:"group text-xs rounded-full mr-4 cursor-pointer hover:bg-gray-100 px-2 py-1",children:[e.jsx(A,{className:"inline-block h-4 w-4 text-gray-500 group-hover:text-gray-600"}),e.jsx("span",{className:"text-gray-500 group-hover:text-gray-600",children:"編集"})]})]})]},s.id))}),e.jsxs("div",{className:"mt-8 text-center text-sm text-gray-600",children:["全 ",j.length," 件"]}),C&&l&&e.jsx("div",{className:"fixed inset-0 z-50 bg-black/40 overflow-y-auto",onClick:o,children:e.jsx("div",{className:"min-h-full flex items-center justify-center px-4 py-8",children:e.jsxs("div",{className:"relative w-full max-w-3xl bg-white rounded-3xl shadow-lg p-6 max-h-[90vh] overflow-y-auto",onClick:s=>s.stopPropagation(),children:[e.jsx("div",{className:"sticky top-0 flex justify-end pb-2",children:e.jsx("button",{type:"button",onClick:o,className:"text-gray-400 hover:text-gray-600",children:e.jsx(f,{className:"h-10 w-10"})})}),e.jsxs("h3",{className:"text-2xl font-semibold mb-4",children:["「",l.company,"」を編集"]}),y&&e.jsx("p",{className:"text-red-500 text-sm mb-3",children:y}),e.jsx(U,{mode:"edit",initialValues:k,onSubmit:S,submitLabel:v?"更新中...":"更新する"})]})})})]})}const X=()=>e.jsx(B,{});export{X as component};
